<!DOCTYPE html>

<html>
	<head>
		<title> Tiny test </title>
		<style>
			.centered {
				display: flex;
				justify-content: center;
			}
		</style>
	</head>
	<body>
		<div class="centered">
			<div id="joystick" style="width:200px;height:200px;margin:50px"></div>
		</div>
	</body>
</html>

<script>

/*
 * Name			 : joy.js
 * @author		 : Roberto D'Amico (Bobboteck)
 * Last modified : 09.06.2020
 * Revision		 : 1.1.6
 *
 * Modification History:
 * Date			Version		Modified By		Description
 * 2021-12-21	2.0.0		Roberto D'Amico New version of the project that integrates the callback functions, while
 *											maintaining compatibility with previous versions. Fixed Issue #27 too,
 *											thanks to @artisticfox8 for the suggestion.
 * 2020-06-09	1.1.6		Roberto D'Amico Fixed Issue #10 and #11
 * 2020-04-20	1.1.5		Roberto D'Amico Correct: Two sticks in a row, thanks to @liamw9534 for the suggestion
 * 2020-04-03				Roberto D'Amico Correct: InternalRadius when change the size of canvas, thanks to
 *											@vanslipon for the suggestion
 * 2020-01-07	1.1.4		Roberto D'Amico Close #6 by implementing a new parameter to set the functionality of
 *											auto-return to 0 position
 * 2019-11-18	1.1.3		Roberto D'Amico Close #5 correct indication of East direction
 * 2019-11-12	1.1.2		Roberto D'Amico Removed Fix #4 incorrectly introduced and restored operation with touch
 *											devices
 * 2019-11-12	1.1.1		Roberto D'Amico Fixed Issue #4 - Now JoyStick work in any position in the page, not only
 *											at 0,0
 *
 * The MIT License (MIT)
 *
 *	This file is part of the JoyStick Project (https://github.com/bobboteck/JoyStick).
 *	Copyright (c) 2015 Roberto D'Amico (Bobboteck).
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

	let StickStatus={xPosition:0,yPosition:0,x:0,y:0,cardinalDirection:"C"};var JoyStick=function(t,e,i){var o=void 0===(e=e||{}).title?"joystick":e.title,n=void 0===e.width?0:e.width,a=void 0===e.height?0:e.height,r=void 0===e.internalFillColor?"#00AA00":e.internalFillColor,s=void 0===e.internalLineWidth?2:e.internalLineWidth,$=void 0===e.internalStrokeColor?"#003300":e.internalStrokeColor,d=void 0===e.externalLineWidth?2:e.externalLineWidth,c=void 0===e.externalStrokeColor?"#008000":e.externalStrokeColor,h=void 0===e.autoReturnToCenter||e.autoReturnToCenter;i=i||function(t){};var S=document.getElementById(t);S.style.touchAction="none";var u=document.createElement("canvas");u.id=o,0===n&&(n=S.clientWidth),0===a&&(a=S.clientHeight),u.width=n,u.height=a,S.appendChild(u);var l=u.getContext("2d"),f=0,k=2*Math.PI,_=(u.width-(u.width/2+10))/2,g=_+5,x=_+30,v=u.width/2,P=u.height/2,p=(u.width,u.height,v),y=P;function C(){l.beginPath(),l.arc(v,P,x,0,k,!1),l.lineWidth=d,l.strokeStyle=c,l.stroke()}function w(){l.beginPath(),p<_&&(p=g),p+_>u.width&&(p=u.width-g),y<_&&(y=g),y+_>u.height&&(y=u.height-g),l.arc(p,y,_,0,k,!1);var t=l.createRadialGradient(v,P,5,v,P,200);t.addColorStop(0,r),t.addColorStop(1,$),l.fillStyle=t,l.fill(),l.lineWidth=s,l.strokeStyle=$,l.stroke()}function L(t){f=1}function F(t){f=1}"ontouchstart"in document.documentElement?(u.addEventListener("touchstart",L,!1),document.addEventListener("touchmove",function t(e){1===f&&e.targetTouches[0].target===u&&(p=e.targetTouches[0].pageX,y=e.targetTouches[0].pageY,"BODY"===u.offsetParent.tagName.toUpperCase()?(p-=u.offsetLeft,y-=u.offsetTop):(p-=u.offsetParent.offsetLeft,y-=u.offsetParent.offsetTop),l.clearRect(0,0,u.width,u.height),C(),w(),StickStatus.xPosition=p,StickStatus.yPosition=y,StickStatus.x=(100*((p-v)/g)).toFixed(),StickStatus.y=(-(100*((y-P)/g)*1)).toFixed(),i(StickStatus))},!1),document.addEventListener("touchend",function t(e){f=0,h&&(p=v,y=P),l.clearRect(0,0,u.width,u.height),C(),w(),StickStatus.xPosition=p,StickStatus.yPosition=y,StickStatus.x=(100*((p-v)/g)).toFixed(),StickStatus.y=(-(100*((y-P)/g)*1)).toFixed(),i(StickStatus)},!1)):(u.addEventListener("mousedown",F,!1),document.addEventListener("mousemove",function t(e){1===f&&(p=e.pageX,y=e.pageY,"BODY"===u.offsetParent.tagName.toUpperCase()?(p-=u.offsetLeft,y-=u.offsetTop):(p-=u.offsetParent.offsetLeft,y-=u.offsetParent.offsetTop),l.clearRect(0,0,u.width,u.height),C(),w(),StickStatus.xPosition=p,StickStatus.yPosition=y,StickStatus.x=(100*((p-v)/g)).toFixed(),StickStatus.y=(-(100*((y-P)/g)*1)).toFixed(),i(StickStatus))},!1),document.addEventListener("mouseup",function t(e){f=0,h&&(p=v,y=P),l.clearRect(0,0,u.width,u.height),C(),w(),StickStatus.xPosition=p,StickStatus.yPosition=y,StickStatus.x=(100*((p-v)/g)).toFixed(),StickStatus.y=(-(100*((y-P)/g)*1)).toFixed(),StickStatus.cardinalDirection=getCardinalDirection(),i(StickStatus)},!1)),C(),w(),this.GetX=function(){return(100*((p-v)/g)).toFixed()},this.GetY=function(){return(-(100*((y-P)/g)*1)).toFixed()}};

	joystick = new JoyStick("joystick", {});
	setInterval(() => {
		let x_position = joystick.GetX();
		let y_position = joystick.GetY();
		(async() => {
			const response = await fetch("/", {
						method: 'POST',
						headers: {},
						body: x_position.toString() + "|" + y_position.toString(),
					});
		})();

	}, 10);
</script>

